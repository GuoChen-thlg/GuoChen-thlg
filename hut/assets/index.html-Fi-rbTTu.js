import{_ as i,c as s,o as a,a as t}from"./app-Df8Sk9Kc.js";const e={},l=t('<p>接着上次的项目，我们这次把项目安装到 Shopify 商店。<br> 首先,我们要有个开发者账号,来这里 <a href="https://www.shopify.com/partners" target="_blank" rel="noopener noreferrer">注册</a>。</p><h3 id="创建公共应用" tabindex="-1"><a class="header-anchor" href="#创建公共应用"><span>创建公共应用</span></a></h3><p>我们创建一个公共应用,这时，我们会得到 <code>client_id</code> <code>client_secret</code> ,然后设置应用的 url 以及 重定向 url</p><p>有条件的可以进行穿透 ,也可以填写本地地址 (https://127.0.0.1:3000/)</p><h3 id="oauth-身份验证" tabindex="-1"><a class="header-anchor" href="#oauth-身份验证"><span>OAuth 身份验证</span></a></h3><p>回到项目中 ,创建路由 安装路由 (/install) 和认证路由 (/auth/callback)</p><p>/install</p><ol><li>获得安装商店 xxx.myshopify.com</li><li>该应用需要的权限</li><li>该应用的 client_id</li><li>重定向 URl</li><li>设置一个随机数</li><li>重定向到</li></ol><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">shop</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/admin/oauth/authorize?client_id=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">client_id</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&amp;scope=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">scopes</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&amp;redirect_uri=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HOST</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/auth/callback&amp;state=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nonce</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>/auth/callback</p><ol><li>获取参数 code, hmac, shop, state, timestamp</li><li>判断 state 与我们设置的随机数一样并且验证 hmac</li><li>通过 code 获取访问令牌</li></ol><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> res</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> fetch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">shop</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/admin/oauth/access_token</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  method</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">POST</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  body</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> JSON</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">stringify</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">({</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    client_id</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> CLIENT_ID</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    client_secret</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> CLIENT_SECRET</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    code</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> code</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }),</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  headers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Content-Type</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">application/json</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> },</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>保存 access_token</li><li>设置 token (JWT 认证)</li><li>进入应用(重定向)</li></ol><p><a href="https://shopify.dev/tutorials/authenticate-with-oauth" target="_blank" rel="noopener noreferrer">认证流程</a></p><h3 id="编写应用功能代码" tabindex="-1"><a class="header-anchor" href="#编写应用功能代码"><span>编写应用功能代码</span></a></h3><p>.......</p>',16),n=[l];function h(p,k){return a(),s("div",null,n)}const d=i(e,[["render",h],["__file","index.html.vue"]]),o=JSON.parse(`{"path":"/article/v6mofflq/","title":"Shopify公共应用开发(2)","lang":"zh-CN","frontmatter":{"title":"Shopify公共应用开发(2)","tags":["Shopify 插件","Shopify 公共应用"],"categories":["Shopify"],"copyright":true,"abbrlink":16015,"date":"2021/03/06 14:37:58","createTime":"2021/03/06 14:37:58","top":null,"author":"天火流光","permalink":"/article/v6mofflq/","description":"接着上次的项目，我们这次把项目安装到 Shopify 商店。 首先,我们要有个开发者账号,来这里 注册。 创建公共应用 我们创建一个公共应用,这时，我们会得到 client_id client_secret ,然后设置应用的 url 以及 重定向 url 有条件的可以进行穿透 ,也可以填写本地地址 (https://127.0.0.1:3000/) O...","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"],["meta",{"property":"og:url","content":"https://blog.thlg.xyz/hut/article/v6mofflq/"}],["meta",{"property":"og:site_name","content":"天火流光"}],["meta",{"property":"og:title","content":"Shopify公共应用开发(2)"}],["meta",{"property":"og:description","content":"接着上次的项目，我们这次把项目安装到 Shopify 商店。 首先,我们要有个开发者账号,来这里 注册。 创建公共应用 我们创建一个公共应用,这时，我们会得到 client_id client_secret ,然后设置应用的 url 以及 重定向 url 有条件的可以进行穿透 ,也可以填写本地地址 (https://127.0.0.1:3000/) O..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"天火流光"}],["meta",{"property":"article:tag","content":"Shopify 插件"}],["meta",{"property":"article:tag","content":"Shopify 公共应用"}],["meta",{"property":"article:published_time","content":"2021-03-06T06:37:58.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Shopify公共应用开发(2)\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2021-03-06T06:37:58.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"天火流光\\"}]}"]]},"headers":[{"level":3,"title":"创建公共应用","slug":"创建公共应用","link":"#创建公共应用","children":[]},{"level":3,"title":"OAuth 身份验证","slug":"oauth-身份验证","link":"#oauth-身份验证","children":[]},{"level":3,"title":"编写应用功能代码","slug":"编写应用功能代码","link":"#编写应用功能代码","children":[]}],"readingTime":{"minutes":1.09,"words":326},"git":{"updatedTime":null,"contributors":[]},"autoDesc":true,"filePathRelative":"Shopify公共应用开发-2.md","categoryList":[]}`);export{d as comp,o as data};
